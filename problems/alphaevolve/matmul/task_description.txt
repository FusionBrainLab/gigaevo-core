TASK DEFINITION - MATRIX MULTIPLICATION TENSOR DECOMPOSITION (n=2, m=4, p=5)

Problem Type: Computational Linear Algebra and Tensor Decomposition
Challenge: Discover the lowest-rank tensor decomposition of the fixed matrix multiplication tensor for n=2, m=4, p=5.

PROBLEM CONTEXT:
Target: Find the minimal rank R for tensors U, V, W such that T_ijk = sum_{r=1..R} U_ir V_jr W_kr exactly reconstructs the matrix multiplication tensor.
Benchmark: Googleâ€™s best known algorithm achieves rank 32 (combined_score = 32 / rank, PRIMARY OBJECTIVE - maximize).
Constraint: The reconstructed tensor must match the ground-truth tensor exactly after optimization (loss <= 1e-6).

OBJECTIVE:
Implement a Python function that returns the factor matrices (U, V, W), tensor dimensions, loss, and rank such that:
- decomposition = (U, V, W) with shapes (n*m, rank), (m*p, rank), (n*p, rank)
- Tensor reconstruction equals the standard matrix multiplication tensor
- Rank is as small as possible

PERFORMANCE METRICS:
- combined_score = 32 / rank (PRIMARY OBJECTIVE - maximize)
- loss (must be near zero for a valid solution)
- rank (integer)
- eval_time (secondary)

VALIDATION REQUIREMENTS:
- Verify factor matrix shapes
- Reconstruct tensor via einsum and ensure exact equality with matmul tensor
- Check rank is integer and loss <= 1e-6

HINTS & STRATEGY:
- Use staged optimization (continuous search -> discrete rounding)
- Enforce constraints via custom rounding, clipping, or search over discrete grids
- Explore schedule/learning rate trade-offs and random restarts
- Ensure reproducibility with fixed seeds


**STRATEGY HINTS**:
- Shape validation: Ensure U, V, W have shapes (n*m, rank), (m*p, rank), (n*p, rank)
- Exact tensor match: reconstructed tensor must equal matmul tensor element-wise
- Loss threshold: enforce loss <= 1e-6 for success
- Rank minimization: combined_score = 32 / rank so lower rank yields higher score
- Initialization sensitivity: multiple restarts or heuristic warm starts help
- Discrete rounding: use STE or grid search to snap factors to valid values
- Numerical stability: consider gradient clipping or normalization
